
from LineFile import *

GOOG_DIR = "/home/piantado/Desktop/mit/Corpora/GoogleNGrams/"
VOCAB_FILE = "Vocabulary.txt"

# Read the vocabulary file
vocabulary = []
for l in open(VOCAB_FILE, "r"): vocabulary.append( l.strip() )

G123 = LineFile(["/tmp/3gm-clean"], header=["w1", "w2", "w3", "cnt123"]) #[GOOG_DIR+"2/2gm-0010"])
#G123.clean() # already done!
#G123.restrict_vocabulary(["w1", "w2", "w3"], vocabulary) # in fields w1 and w2, restrict our vocabulary

G = G123.copy()

# now sort it
G12 = G123.copy()
G12.delete_columns(["w3"])
G12.sort(key=["w1","w2"] )
G12.resum_equal( ["w1","w2"], ["cnt123"] )
G.sort(key=["w1", "w2"]) # do this for merging
G.merge(G12, keys1=["w1", "w2"], keys2=["w1", "w2"], newheader=["cnt12"])

G23 = G123.copy()
G23.delete_columns(["w1"])
G23.sort(key=["w2","w3"] )
G23.resum_equal( ["w2","w3"], ["cnt123"] )
G.sort(key=["w2", "w3"]) # do this for merging
G.merge(G23, keys1=["w2", "w3"], keys2=["w2", "w3"], newheader=["cnt23"])

G1 = G123.copy()
G1.delete_columns(["w2","w3"])
G1.sort(key=["w1"] )
G1.resum_equal( ["w1"], ["cnt123"] )
G.sort(key=["w1"]) # do this for merging
G.merge(G1, keys1=["w1"], keys2=["w1"], newheader=["cnt1"])

G2 = G123.copy()
G2.delete_columns(["w1","w3"])
G2.sort(key=["w2"] )
G2.resum_equal( ["w2"], ["cnt123"] )
G.sort(key=["w2"]) # do this for merging
G.merge(G2, keys1=["w2"], keys2=["w2"], newheader=["cnt2"])

G3 = G123.copy()
G3.delete_columns(["w1","w3"])
G3.sort(key=["w3"] )
G3.resum_equal( ["w3"], ["cnt123"] )
G.sort(key=["w3"]) # do this for merging
G.merge(G3, keys1=["w3"], keys2=["w3"], newheader=["cnt3"])

print G.header

#G2.cat()
#print G2.header



#TODO: OUR RESUM_EQUAL DOES NOT WORK IF ONLY ONE KEY --- MAYBE NOT PRINTING THE END?

#-- HMM IT SEEMS TO PRINT A 0 ONE FIRST






















